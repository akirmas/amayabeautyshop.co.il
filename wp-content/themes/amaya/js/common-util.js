(function(){window._atpopobj.popupUtil=window._atpopobj.popupUtil||{};window._atpopobj.popupUtil=function(){var q=window._atpopobj.loaderUtil;var j=function(B,A,D,E,F,C,z){B.addClass("floating");if(z!=null){z.postAnimationCallback=function(){B.addClass("shown floating");if(E){E.call(this)}};window._atpopobj.animationUtil.animateEl(B,z,D)}else{B.addClass("shown");if(A.DisplayProps.AnimationProps.AnimationType=="None"){if(E){E.call(this)}}}if(B.find(".p-close-btn").length==1){B.find(".p-close-btn").bind("click",function(){B.parent().find(".ui-tooltip.qtip").remove();B.remove();q.callbackEvent(D,"close")})}};var d=function(z,A){if(!A.browser.msie||parseInt(A.browser.version)>=9){z.dialog("destroy")}else{z.dialog("close")}};var i=function(I,A,F,J,B,H,E){var C=A.DisplayProps.IsCloseOnOutsideClick||false;var D=A.DisplayProps.IsFitToPage||false;var G=A.OnDisplayEnd;I.addClass(J);var z=null;if(B){z={Type:A.DisplayProps.AnimationProps.AnimationType,Duration:A.DisplayProps.AnimationProps.AnimationTime,Source:A.DisplayProps.AnimationProps.AnimationSource,TargetPosition:J,IsFitToPage:D,ParentContainer:H,OnAnimationComplete:G}}if(A.DisplayType=="Popup"){q.loadJQueryPlugin("jquery-ui","ui",F,function(){I.on("dialogopen",function(){var N=E(I).dialog("widget");if(z!=null){window._atpopobj.animationUtil.animateEl(N,z,F)}});var L={};var M={at:J,my:J,of:H};L.modal=true;L.position=M;E(window).resize(function(){I.dialog("option","position",M)});if(D){L.width="100%"}else{L.width=I.css("width")}if(A.DisplayProps.AnimationProps.AnimationType=="FadeIn"){L.show={effect:"fade",duration:A.DisplayProps.AnimationProps.AnimationTime}}L.open=function(){var N=I.dialog("widget");if(!A.DisplayProps.AnimationProps.IsUseMask){N.parent().find(".ui-widget-overlay").addClass("no-mask")}I.parent().promise().done(function(){if(A.DisplayProps.AnimationProps.AnimationType=="FadeIn"||A.DisplayProps.AnimationProps.AnimationType=="None"){if(G){G.call(this)}}})};L.dialogClass=J+" fixed dialog_"+F.RootElementId;I.dialog(L);if(C&&H&&F.RootElementId){E(H).bind("click",function(N){if(I==null){return}var O=N.target?N.target:N.srcElement;if(E(O).attr("id")!=F.RootElementId&&E(O).parents("#"+F.RootElementId).length==0&&E(O).parents(".__atPopupQtips").length==0&&!E(O).hasClass("__atPopupQtips")&&E(O).parents(".ui-datepicker.ui-widget").length==0&&E(O).parents(".ui-datepicker-header").length==0&&!E(O).hasClass("ui-datepicker")&&E(O).parents("#country-listbox").length==0){I.parents("body").find(".__atPopupQtips").remove();d(I,E);I.remove();I=null;q.callbackEvent(F,"close")}})}I.find(".p-close-btn").bind("click",function(){I.parents("body").find(".ui-tooltip.qtip").remove();d(I,E);q.callbackEvent(F,"close")});F.OnClose=function(){I.parents("body").find(".ui-tooltip.qtip").remove();d(I,E)}})}else{if(A.DisplayType=="Floating"){if(D){I.addClass("fit-to-page")}else{if(J.indexOf("left")<0&&J.indexOf("right")<0){var K=I.find(".bl-block").css("width").replace("px","");I.css("margin-left",-(K/2)+"px")}if(J.indexOf("center")>=0){I.css("margin-top",-(I.height()/2)+"px")}}j(I,A,F,G,J,E,z);F.OnClose=function(){I.hide()}}}};var p=function(A,C,z){var B=!(A.DisplayProps.AnimationProps.AnimationType=="None"||(A.DisplayType=="Popup"&&A.DisplayProps.AnimationProps.AnimationType=="FadeIn"));if(B){q.loadJsLibPath("animation-util","window._atpopobj.animationUtil",C,function(){z.call(this,B)})}else{z.call(this,B)}};var f=function(C,B,F){if(F.IsEmbed){return}var E=F.JQueryHandler||jQuery;var z=B.DisplayProps.ParentEl||window;var G=E(C);var A="p-close-btn";if(!B.DisplayProps.IsUseCloseButton){A+=" mobile-only"}G.find(".bl-block").append('<div class="'+A+'"></div>');if(B.DisplayType=="Popup"&&(F.IsPreviewMode||(F.VersionInfo&&F.VersionInfo.ShowPoweredBy))){G.find(".bl-block-content").after((typeof(B.PoweredByContent)!=undefined)?B.PoweredByContent:"")}if(G.length==0){q.logError("element not found with id: "+F.RootElementId,F);return}var H=B.DisplayProps.DisplayPosition||"center";var D=B.DisplayProps.IsFitToPage||false;if(D){if(H.indexOf("Top")>=0){H="top"}else{if(H.indexOf("Center")>=0){H="center"}else{H="bottom"}}}else{switch(H){case"TopRight":H="right top";break;case"TopLeft":H="left top";break;case"CenterRight":H="right center";break;case"CenterLeft":H="left center";break;case"BottomRight":H="right bottom";break;case"BottomLeft":H="left bottom";break;default:H=H.toLowerCase();break}}p(B,F,function(I){i(G,B,F,H,I,z,E)})};var a=false;var b=[];function r(A,z){z(A).addClass("disabled");a=true}function x(A,z){z(A).removeClass("disabled");a=false}function n(){return a}function l(A,z){if(z.browser.msie&&parseInt(z.browser.version)<=9){A.find("input[type=text][placeholder]").each(function(B,C){if(z(this).attr("ghost-text")!="undefined"){z(this).attr("ghost-text",z(this).attr("placeholder"));z(this).addClass("ghost");if(z(this).val()===""){z(this).attr("value",z(this).attr("ghost-text")).css({color:"#999"})}}});A.find(".ghost").focus(function(){if(z(this).val()===z(this).attr("ghost-text")){z(this).val("").css({color:"#000000"})}}).blur(function(){if(z(this).val()===""){z(this).val(z(this).attr("ghost-text")).css({color:"#999"})}}).change(function(){if(z(this).val()!==z(this).attr("ghost-text")){z(this).css({color:"#000000"})}})}else{A.find("input[type=text][placeholder]").each(function(B,C){if(z(this).val()===""){z(this).find("input[type=text][placeholder]").val("")}})}}function c(A,z){if(z.browser.msie&&parseInt(z.browser.version)<=9){A.find("input[type=text][placeholder]").each(function(B,C){if(z(this).attr("ghost-text")!="undefined"){if(z(this).val()===z(this).attr("ghost-text")){z(this).attr("value","")}}})}}function v(A,z){if(z.browser.msie&&parseInt(z.browser.version)<=9){A.find("input[type=text][placeholder]").each(function(B,C){if(z(this).attr("ghost-text")!="undefined"){if(z(this).val()===""){z(this).attr("value",z(this).attr("ghost-text")).css({color:"#999"})}}})}}function e(z,C,A,B){A.IsJsonp=false;if(z.browser&&z.browser.msie&&z.browser.version<=9&&z.browser.version>=8){A.IsJsonp=true;z.ajax({type:"POST",data:A,url:C,async:false,jsonpCallback:"jsonCallback",contentType:"application/json",dataType:"jsonp",success:function(D,F,E){B(D)}})}else{if(z.browser&&z.browser.msie&&z.browser.version<8){return false}else{z.ajax({url:C,cache:false,data:A,dataType:"json",type:"POST",success:function(D,F,E){B(D)},error:function(D,E,F){}})}}}function w(z,B,A,E){b=[];var F=E.PageProtocol||"";var D=F+E.SignUpLeadBaseUrl+"Customers/SignupFormLeadHandler.ashx";var G={UserId:E.UserId,PopupId:E.PopupId,BlockId:B.closest(".bl-block").attr("id"),PageUrl:encodeURIComponent(document.location.href)};var C=false;z.each(B.find("input.signup-field,div.custom-signup-field"),function(H,I){var K=z(I).attr("data-field-type");var J=z(I).attr("data-field-source");if(J.toLowerCase()=="email"){C=true}});z.each(B.find("input.signup-field,div.custom-signup-field"),function(H,I){var K=z(I).attr("data-field-source").toLowerCase();if(z(I).attr("data-field-type")=="date"){val=z(I).val();if(val!=""){val=g(z(I).datepicker("getDate"))}}else{if(K=="sms"){try{if(z(I).val()!=""){if(window.internal_jQuery){val=window.internal_jQuery(I).intlTelInput("getNumber")}else{val=z(I).intlTelInput("getNumber")}}else{val=""}}catch(J){if(E.CountryCode==E.IsraelCode){val=z(I).val();val=RegulateMobileNumber("972",val)}else{val=z(I).val()}if(z(I).attr("data-mandatory")=="false"&&C&&(intlGD(z(I)).dialCode==val.replace("+",""))){val=""}}}else{val="";if(z(I).is("input")){val=z(I).val()}else{if(z(I).find("input").length>0){z(I).find("input:checked").each(function(){if(val!=""){val+=","}val+=this.value})}else{z(I).find("select option:selected").each(function(){if(val!=""){val+=","}val+=this.value})}}}}b[b.length]={key:z(I).attr("data-field-source"),val:val};G[z(I).attr("data-field-source")]=val});if(!C){b[b.length]={key:"Email",val:""};G.Email=""}e(z,D,G,function(H,J,I){if(A){A.call(this,H)}})}function o(D,z,I){var H=true;var K=D.parents(".bl-block-content-table").hasClass("bl-block-dir-ltr")?"ltr":"rtl";var J=(K=="ltr")?"bottom left":"bottom right";var A=(K=="ltr")?"top right":"top left";var M=(K=="ltr")?-8:8;var N=6;var G=false;var F=false;c(D,z);z.each(D.find("input.signup-field,div.custom-signup-field"),function(O,P){var R=z(P).attr("data-field-type");var Q=z(P).attr("data-field-source");if(Q.toLowerCase()=="sms"){G=true}if(Q.toLowerCase()=="email"){F=true}});z.each(D.find("input.signup-field,div.custom-signup-field"),function(O,P){var V="";if(z(P).is("input")){V=z(P).val()}else{if(z(P).find("input").length>0){V=z(P).find("input:checked").val()}else{V=z(P).find("select option:selected").val()}}if(!V){V=""}else{V=z.trim(V);z(P).val(V)}var U=z(P).attr("data-field-type");var T=z(P).attr("data-field-source");var S=z(P).attr("data-mandatory");var R=true;if(F){switch(U){case"email":R=y(V,z);if(V==""&&S.toString()=="false"&&G){_formEmail=V;R=true;break}}}if(G){switch(T.toLowerCase()){case"sms":try{if(window.internal_jQuery){R=(window.internal_jQuery(P).intlTelInput("isValidNumber")&&window.internal_jQuery(P).intlTelInput("getNumberType")==1)}else{R=(z(P).intlTelInput("isValidNumber")&&z(P).intlTelInput("getNumberType")==1)}}catch(Q){R=intlVN(z(P),I.CountryCode==I.IsraelCode)}if(S.toString()=="false"&&F&&((V=="")||(V=="+"))){R=true;V="";_formEmail=""}if(!F){_formEmail=""}break}}if(R&&z(P).attr("data-mandatory")=="true"){R=(V!="")}z(P).qtip("destroy");if(!R){z(P).qtip({overwrite:false,content:z(P).attr("data-field-validation-msg"),position:{my:J,at:A,viewport:z(window),adjust:{x:M,y:N}},show:{event:false,ready:true},hide:{event:false,inactive:2000},restrictParentElId:I.RootElementId,style:{classes:"ui-tooltip-red ui-tooltip-rounded __atPopupQtips"},});H=false}});var B=D.find(".confirm-emails");if(B.length==1&&!B.hasClass("hidden")){var L=B.attr("data-field-validation-msg");var E=B.find("input:checkbox");z(E).qtip("destroy");if(L&&!E.is(":checked")){z(E).qtip({overwrite:false,content:L,position:{my:J,at:A,viewport:z(window),adjust:{x:M,y:N}},show:{event:false,ready:true},hide:{event:false,inactive:2000},restrictParentElId:I.RootElementId,style:{classes:"ui-tooltip-red ui-tooltip-rounded __atPopupQtips"}});H=false}}var C=D.find(".confirm-terms");if(C.length==1&&!C.hasClass("hidden")){var L=C.attr("data-field-validation-msg");var E=C.find("input:checkbox");z(E).qtip("destroy");if(L&&!E.is(":checked")){z(E).qtip({overwrite:false,content:L,position:{my:J,at:A,viewport:z(window),adjust:{x:M,y:N}},show:{event:false,ready:true},hide:{event:false,inactive:2000},restrictParentElId:I.RootElementId,style:{classes:"ui-tooltip-red ui-tooltip-rounded __atPopupQtips"}});H=false}}return H}function y(C,z){C=z.trim(C);if(C.indexOf(" ")>-1){return false}var A="^[$&+a-zA-Z_0-9.-]{1,}@[a-zA-Z_0-9.-]+\\.[a-zA-Z_0-9]{2,}$";var B=new RegExp(A);return B.test(C)}function h(){if(navigator.languages&&typeof(navigator.languages)!=="undefined"&&navigator.languages.length>0){return navigator.languages[0]}return navigator.language?navigator.language:navigator.userLanguage}function g(B){var z=B.getDate();z=(z<10)?("0"+z):z;var A=B.getMonth()+1;A=(A<10)?("0"+A):A;var C=B.getFullYear()+"";return(C+A+z)}var u=function(z,C,B,A){z(C).find("iframe.at-player").each(function(E,G){var H=parseInt(z(this).attr("img_width"));var D=parseInt(z(this).attr("img_height"));if(H){z(this).attr("width",H)}if(D){z(this).attr("height",D)}var F=z(this).prev();z(this).css({"max-width":F.css("max-width")});z(this).css({"max-height":F.css("max-height")});F.hide();z(this).show()});A.call(this)};var s=function(C,E,B,D,z){var A=B.find(" input[data-field-type='date']");if(A.length>0){q.loadJQueryPlugin("jquery-ui","ui",D,function(){var F=(h()=="en-US")?"mm-dd-yy":"dd-mm-yy";C(A).each(function(){C(this).datepicker({dateFormat:F,changeMonth:true,changeYear:true,yearRange:"1900:2100",minDate:new Date(1900,1-1,1),onSelect:function(H,K){var J=C(this);var O="popup_sig_"+J.attr("data-field-source");var N="."+O;if(C(N).length>0){return}J.after("<span class='date-x-sign "+O+"' style=''>X</span>");var G=J.offset();var I=(J.height()/2-4);var M=0;var L=true;if(J.css("text-align")==="left"||J.css("text-align")==="right"){L=J.css("text-align")==="left"}else{L=J.css("direction")==="ltr"}if(L){M=G.left+J.width()-10}else{M=G.left+10}C(N).offset({top:G.top+I,left:M}).click(function(){C(this).remove();J.val("").blur()})}})});z.call(this)})}else{z.call(this)}};var t=function(A,B,C){var z=B.JQueryHandler;if(z(A).find(".bl-block-content-item-signupfieldpage").length==0){q.logError("signup form not found with class bl-block-content-item-signupfieldpage",B);return}if(z(A).find(".bl-block-content-item-signupfieldpage").length>0){z.each(z(A).find(".bl-block-content-item-signupfieldpage"),function(D,E){l(z(this),z);if(z(this).find(".uni_style").length>0){z(this).find(".uni_style").removeAttr("disabled").uniform();z(this).find(".uni-radio.uni-disabled").removeClass("uni-disabled");z(this).find(".uni-checker.uni-disabled").removeClass("uni-disabled")}z(this).find("select").removeAttr("disabled");s(z,z(A),z(E),B,function(){z.each(z(E).find("input.signup-field"),function(G,H){if(z(H).attr("data-field-type")!="date"){z(H).removeAttr("readonly")}});z(E).find("input:checkbox").removeAttr("disabled");var F=z(E);if(z(E).parent().find(".bl-block-button-content-wrapper").length==0){q.logError("signup form submit button not found with class bl-block-button-content-wrapper",B);return}z(E).parent().find(".bl-block-button-content-wrapper").bind("click",function(H){if(n()){return}r(this,z);var I=F;if(!o(I,z,B)){v(I,z);x(this,z);return false}var G=this;w(z,I,function(L){if(L&&L.IsSuccess){q.setPopupSubmitted();if(L.Info.PostSubmitType=="Message"){x(G,z);var J="auto";if(z(G).parents(".bl-block-content-column").find(".bl-signup-container").length==1){J=z(G).parents(".bl-block-content-column").find(".bl-signup-container").height()}if(J!="auto"){J=J+"px"}if(z(G).parent().find(".post-submit-msg").length==0){z(G).parents(".bl-block-content-column").addClass("post-submit-msg-container");z(G).parents(".bl-signup-container").find("div").hide();z(G).parents(".bl-signup-container").append('<div class="post-submit-msg" style="height:'+J+'">'+L.Info.PostSubmitValue+"</div>")}q.callbackEvent(B,"submit")}else{if(L.Info.PostSubmitType=="Url"){if(L.IsPostUrlFields){z(G).parent().append('<form id="submitForm" target="_self" method="post"></form>');var M=z(G).parent().find("#submitForm");M.attr("action",L.Info.PostSubmitValue);for(var K=0;K<b.length;K++){M.append('<input type="hidden" name="'+b[K].key+'" value="'+b[K].val+'" />')}M.submit()}else{location.href=L.Info.PostSubmitValue}}else{if(B.OnClose){B.OnClose.call(this)}q.callbackEvent(B,"submit")}}}else{x(G,z)}},B)})})})}};var k=function(B,z,A){q.loadJQuery(A,function(D){var C=z.Content||"";q.loadMainCss(z.IsRtl,A,function(){q.logMessage("main css loaded",A);if(C!=""){C='<div id="'+A.RootElementId+'">'+C+"</div>";D(B).append(C)}var F=D(B).find("#"+A.RootElementId);if(F.length!=1){q.logError("element not found with id: "+A.RootElementId,A);return}q.logMessage("Processing element with id: "+A.RootElementId,A);var E=A.IsPreviewMode||false;u(D,F,A,function(){f(F[0],z,A);if(!E){q.loadJQueryPlugin("jquery-migrate.min","migrateMute",A,function(G){if(!window.require||typeof(requirejs)==="undefined"){q.loadJQueryPlugin("jquery.qtip","qtip",A,function(H){if(H(F[0]).find(".uni_style").length>0){q.loadJQueryPlugin("jquery.uniform","uniform",A,function(I){t(F[0],A,function(){})})}else{t(F[0],A,function(){})}})}else{requirejs.config({paths:{qtip:q.getExtJsPath("jquery.qtip",A).replace(".js",""),uniform:q.getExtJsPath("jquery.uniform",A).replace(".js","")}});requirejs(["qtip"],function(){window._atpopobj.loaderUtil.logMessage("qtip loaded via require.js",A);requirejs(["uniform"],function(){window._atpopobj.loaderUtil.logMessage("uniform loaded via require.js",A);t(F[0],A,function(){})})})}})}})})})};var m=false;if(/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)){m=true}return{resetPopup:function(B,z,A){q.loadJQuery(A,function(C){if(C(B).find("#"+A.RootElementId).length==1){C(B).find("#"+A.RootElementId).remove();C(B).find("#dialog__"+A.RootElementId).remove()}window._atpopobj.popupUtil.processPopup(B,z,A)})},processPopup:function(E,z,C){if(C.IsEmbed){k(E,z,C)}else{if(m&&(z.DisplayProps.ShowType=="HalfPageScroll"||z.DisplayProps.ShowType=="FullPageScroll")){z.DisplayProps.ShowType="OnPageLoad"}var D=z.DisplayProps.ShowType;var B=false;var A=E.ownerDocument;var F=A.defaultView||A.parentWindow;C.TargetDocument=A;switch(D){case"OnPageLoad":if(A.readyState=="complete"){k(E,z,C)}else{F.onload=function(){k(E,z,C)}}break;case"AfterPageLoad":F.setTimeout(function(){k(E,z,C)},z.DisplayProps.ShowDelay);break;case"IdleTime":q.loadJQueryPlugin("jquery-idle","idle",C,function(G){G(A).idle({onIdle:function(){if(!B){B=true;k(E,z,C)}},idle:z.DisplayProps.ShowDelay})});break;case"HalfPageScroll":case"FullPageScroll":q.loadJQuery(C,function(G){G(A).bind("scroll",function(H){if(B){return}var I=G(this).height();if(D=="HalfPageScroll"){I=I/2}if(G(F).scrollTop()+G(F).height()>=I){if(!B){B=true;k(E,z,C)}}})});break}}}}}()})();